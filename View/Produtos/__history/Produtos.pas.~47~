unit Produtos;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Data.DB, Vcl.Grids, Vcl.DBGrids,
  Vcl.ToolWin, Vcl.ActnMan, Vcl.ActnCtrls, Vcl.ActnMenus, Vcl.Menus,
  Vcl.StdCtrls, Datasnap.DBClient, FireDAC.VCLUI.Wait, FireDAC.Stan.Def, FireDAC.Comp.Client,
  FireDAC.Phys.PGDef, FireDAC.Stan.Intf, FireDAC.Phys, FireDAC.Phys.PG,
  FireDAC.Stan.Option, FireDAC.Stan.Param,
  FireDAC.Stan.Error, FireDAC.DatS, FireDAC.Phys.Intf, FireDAC.DApt.Intf,
  FireDAC.Stan.Async, FireDAC.DApt, FireDAC.Comp.DataSet;

type
  TfrmCadProdutos = class(TForm)
    dbgProdutos: TDBGrid;
    Button1: TButton;
    dtsProdutos: TDataSource;
    cdsProdutos: TClientDataSet;
    drvConexao: TFDPhysPgDriverLink;
    cdsProdutosid: TIntegerField;
    cdsProdutosnome: TStringField;
    cdsProdutosdescricao: TStringField;
    cdsProdutosprecocusto: TStringField;
    cdsProdutosprecovenda: TStringField;
    procedure FormCreate(Sender: TObject);
    procedure FormDestroy(Sender: TObject);


  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  frmCadProdutos: TfrmCadProdutos;

implementation

{$R *.dfm}

procedure TfrmCadProdutos.FormCreate(Sender: TObject);
var
  lQuery: TFDCustomQuery;
  lcontador: double;
begin
  cdsProdutos.CreateDataSet;
  cdsProdutos.Open;
  lquery := TFDCustomQuery.Create(self);
  lquery.ConnectionName := 'conectVendas';
  lquery.SQL.Add('SELECT * FROM "Dados"."cadproduto"');
  lquery.open;

  cdsProdutos.EmptyDataSet;
  // eof - end of file

  while (not lquery.eof) do

  begin
    cdsProdutos.Append;
    cdsProdutos.fields.fieldByName('id').AsString :=
    lquery.fields.fieldByname('idcadproduto').AsString;
        cdsProdutos.fields.fieldByName('nome').AsString :=
    lquery.fields.fieldByname('nomeproduto').AsString;
        cdsProdutos.fields.fieldByName('descricao').AsString :=
    lquery.fields.fieldByname('descricaoproduto').AsString;
    cdsProdutos.Post;
    lquery.next;
  end;

  cdsProdutos.first;
  FreeAndNil(lquery);
end;


Procedure TfrmCadProdutos.FormDestroy(Sender:TObject);
  begin
    FreeAndNil(cdsProdutos);
  end;

end.
